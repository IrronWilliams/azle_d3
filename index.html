<!DOCTYPE html>
<html>

<head>
<script src='http://code.jquery.com/jquery-3.3.1.min.js'></script>
<!--<script src='http://worldofdatascience.com/kedion.min.js'></script>-->
    <script src="../Kedion/main.js"></script>
</head>

<body>
</body>
</html>

<script>

load_script('scripts/wrapped_functions.js')
load_script('scripts/code_modals.js')

// ******* prepare page ********
load_fonts({
    "font": "Ubuntu"
})

style_body({
    "background": "rgb(85, 85, 85)",
    "font-family": "Ubuntu",
    "min-width": "1300px"
})

add_navigation_bar({
    "this_class": "my_nav"
})

style_navigation_bar('my_nav', 1, {
    "background-color": "rgba(91, 95, 100, 0.95)",
    "border-radius" : "4px",
    "margin-bottom" : "20px",
    "height" : "auto"
})

add_top_button({
    "this_class": "to_top_button",
    "text": "TOP",
    "side": "right"
})

add_layout('my_nav', 1, {
    "this_class": "nav_layout",
    "cell_class": "nav_layout_cells",
    "row_class": "nav_layout_rows",
    "number_of_rows": 1,
    "number_of_columns": 3
})

style_layout('nav_layout', 1, {
    "height": "auto",
    "column_widths": ['33%', '33%', '33%'],
    "border": 0
})

style_layout('nav_layout_cells', 1, {
    "valign" : "middle"
})

style_layout('nav_layout_cells', 2, {
    "halign" : "center"
})

add_image('nav_layout_cells', 1, {
"this_class" : "logo",
"image_path" : "img/logo.png"
})
style_image('logo', 1, {
"width" : "250px",
"padding" : "10px",
"shadow" : "drop-shadow(4px 4px 16px rgb(154, 148, 151))"
})
add_event('logo', 1, {
"type" : "click",
"function" : "navigate_to('http://www.worldofdatascience.com', 'new_tab')"
})

add_image('nav_layout_cells', 2, {
"this_class" : "k_logo",
"image_path" : "img/logo_banner.png"
})
style_image('k_logo', 1, {
"width" : "70%"
})

add_navigation_bar({
    "this_class": "explain_nav"
})

style_navigation_bar('explain_nav', 1, {
    "background-color": "transparent",
    "border-radius" : "4px",
    "margin-bottom" : "20px",
    "height" : "auto"
})

add_layout('explain_nav', 1, {
    "this_class": "hold_explain_buttons",
    "cell_class": "hold_explain_buttons_cells",
    "row_class": "hold_explain_buttons_rows",
    "number_of_rows": 1,
    "number_of_columns": 3
})

style_layout('hold_explain_buttons', 1, {
    "height": "auto",
    "width" : "auto",
    "table-layout": "fixed",
    "align" : "center",
    "border": 0
})

all_style_layout('hold_explain_buttons_cells', {
    "halign" : "center"
})

explain_buttons = ['CREATING WRAPPER ARGUMENTS', 'CREATING EXTRA FUNCTIONS', 'BINDING TO UI ELEMENTS']
call_multiple({
"iterations" : explain_buttons.length,
"function" : `
    add_button('hold_explain_buttons_cells', index + 1, {
        "this_class" : "explain_button",
        "text" : explain_buttons[index]
    })
    all_style_button('explain_button', {
        "background" : "grey"
    })
`
})



add_spa({
    "this_class" : "sections",
    "sections" : 6
})

all_style_spa('sections', {
    "background" : "rgba(91, 95, 100, 0.95)",
    "width" : "90%",
    "height" : "auto"
})

add_navigation_bar({
    "this_class": "footer"
})

style_navigation_bar('footer', 1, {
    "background" : "rgba(91, 95, 100, 0.95)",
    "height" : "auto"
})

add_layout('footer', 1, {
    "this_class": "footer_layout",
    "cell_class": "footer_layout_cells",
    "row_class": "footer_layout_rows",
    "number_of_rows": 1,
    "number_of_columns": 2
})

style_layout('footer_layout', 1, {
    "height": "auto",
    "width" : "auto",
    "align" : "center",
    "border": 0
})

add_text('footer_layout_cells', 1, {
    "this_class" : "footer_text",
    "text" : "Written in Kedion"
})
style_text('footer_text', 1, {
    "color" : "lightgrey"
})
add_image('footer_layout_cells', 2, {
    "this_class" : "footer_logo",
    "image_path" : "img/kedion_logo.png"
})
style_image('footer_logo', 1, {
    "width" : "50px",
    "float" : "right"
})

// ******* setting up layouts and styling that apply to all sections ********
call_multiple({
"iterations" : $('.sections').length,
"function" : `
	add_layout('sections', index + 1, {
    	"this_class": "sectional_layout",
    	"cell_class": "sectional_layout_cells",
    	"row_class": "sectional_layout_rows",
    	"number_of_rows": 1,
    	"number_of_columns": 2
	})
	all_style_layout('sectional_layout', {
    	"height": "auto",
    	"column_widths": ['20%', '80%'],
    	"border": 1
	})

	add_text('sectional_layout_cells', (index*2) + 1, {
	    "this_class" : "examples_title",
	    "text" : "EXAMPLES"
	})

	add_layout('sectional_layout_cells', (index*2) + 1, {
    	"this_class": "options_layout",
    	"cell_class": "options_layout_cells",
    	"row_class": "options_layout_rows",
    	"number_of_rows": 10,
    	"number_of_columns": 1
	})


`
})

// ******* adding all section 1 buttons and icons ********
button_titles = ["bar color", "text color", "text size", "bottom", "top", "left", "right", "fly away animation", "change data", "START OVER"]
call_wrapper_functions = ["bar_color()", "text_color()", "text_size()", "bottom()", "top()", "left()", "right()", "animate_zoomOutUp()", "update_data_full()", "start_over()"]
call_multiple({
	"iterations" : button_titles.length,
	"function" : `
	    add_layout('options_layout_cells', index + 1, {
    	    "this_class": "butt_and_code_layout",
    	    "cell_class": "butt_and_code_layout_cells",
    	    "row_class": "butt_and_code_layout_rows",
    	    "number_of_rows": 1,
    	    "number_of_columns": 2
	    })
	    all_style_layout('butt_and_code_layout', {
    	    "height" : "auto",
    	    "width"  : "auto",
    	    "border" : 0
	    })
	    add_button('butt_and_code_layout_cells', (index*2) + 1, {
	        'this_class'  : 'option_button', 
	        'text' : button_titles[index]
	    })
	    all_style_button('option_button', {
	        "width" : "190px",
	        "background" : "rgb(16, 168, 180)"
	    })
	    add_event('option_button', index+1, {
	        "type" : "click", 
	        "function" : call_wrapper_functions[index]
	    })
	    add_event('option_button', index+1, {
	        "type" : "click",
	        "function" : "all_style_button('option_button', {'outline' : 0}); style_button('option_button', get_target_instance(this.id), {'outline' : '2px solid yellow'})"
	    })

	    add_icon('butt_and_code_layout_cells', (index*2) + 2, {
	        "this_class" : "code_icon",
	        "icon_class" : "fa-file-code-o"
	    })
	    add_event('code_icon', last_class_instance('code_icon'), {
	        "type" : "click",
	        "function" : "pop_code_modal(this.id)"
	    })

	    all_style_icon('code_icon', {
	        "font-size" : "30px",
	        "color" : "rgba(221, 173, 81, 0.92)",
	        "padding" : "2px",
	        "cursor" : "pointer"
	    })

	    if(index == 9) {
	    style_button('option_button', index+1, {
	        "background" : "rgba(242, 155, 45, 0.97)"
	    })
	    style_icon('code_icon', index + 1, {
	        "visibility" : "hidden"
	    })
	    }
`
})


// ******* adding all section 2 buttons and icons ********
button_titles_b = ["circle size", "circle opacity", "chart width"]
call_wrapper_functions_b = ["circle_size()", "circle_opacity()", "change_width()"]
call_multiple({
	"iterations" : button_titles_b.length,
	"function" : `
	    new_index = 10 + index

	    add_layout('options_layout_cells', new_index + 1, {
    	    "this_class": "butt_and_code_layout",
    	    "cell_class": "butt_and_code_layout_cells",
    	    "row_class": "butt_and_code_layout_rows",
    	    "number_of_rows": 1,
    	    "number_of_columns": 2
	    })
	    all_style_layout('butt_and_code_layout', {
    	    "height" : "auto",
    	    "width"  : "auto",
    	    "border" : 0
	    })

	    add_button('butt_and_code_layout_cells', (new_index*2) + 1, {
	        'this_class'  : 'option_button_b',
	        'text' : button_titles_b[index]
	    })
	    style_button('option_button_b', index + 1, {
	        "width" : "190px",
	        "background" : "rgb(16, 168, 180)"
	    })
	    add_event('option_button_b', index+1, {
	        "type" : "click",
	        "function" : call_wrapper_functions_b[index]
	    })
	    add_event('option_button_b', new_index+1, {
	        "type" : "click",
	        "function" : "all_style_button('option_button', {'outline' : 0}); style_button('option_button', get_target_instance(this.id), {'outline' : '2px solid yellow'})"
	    })
	    add_icon('butt_and_code_layout_cells', (new_index*2) + 2, {
	        "this_class" : "code_icon",
	        "icon_class" : "fa-file-code-o"
	    })
	    add_event('code_icon', last_class_instance('code_icon'), {
	        "type" : "click",
	        "function" : "pop_code_modal(this.id)"
	    })

	    all_style_icon('code_icon', {
	        "font-size" : "30px",
	        "color" : "rgba(221, 173, 81, 0.92)",
	        "padding" : "2px",
	        "cursor" : "pointer"
	    })
	    if(index == 10) {
	    style_button('option_button_b', new_index+1, {
	        "background" : "rgba(242, 155, 45, 0.97)"
	    })
	    }
`
})

add_radiobutton('options_layout_cells', 14, {
    "this_class" : "choose_data_check",
    "text_class" : "choose_data_label",
    "text" : "DATASET 1"
})
add_event('choose_data_check', 1, {
    "type" : "click",
    "function" : "dataset1()"
})
add_radiobutton('options_layout_cells', 15, {
    "this_class" : "choose_data_check",
    "text_class" : "choose_data_label",
    "text" : "DATASET 2"
})
add_event('choose_data_check', 2, {
    "type" : "click",
    "function" : "dataset2()"
})
add_radiobutton('options_layout_cells', 16, {
    "this_class" : "choose_data_check",
    "text_class" : "choose_data_label",
    "text" : "DATASET 3"
})
add_event('choose_data_check', 3, {
    "type" : "click",
    "function" : "dataset3()"
})
all_style_text('choose_data_label', {
    "color" : "white"
})

add_dropdown("options_layout_cells", 17, {
    "this_class" : "data_dropdown",
    "options" : ["Setosa", "Versicolor", "Virginica"],
    "title" : "choose class..."
    })
style_dropdown('data_dropdown', 1, {
    "width" : "200px"
})
add_event('data_dropdown', 1, {
    "type" : "change",
    "function" : "choose_class(this.value)"
})

// *************************Kedion D3***********************************

barchart_wrapper_args = {
    "data_path" : "../data/bar_data.tsv",
    "y_title" : "AVG RETURN",
    "top_choice" : 30,
    "right_choice" : 30,
    "bottom_choice" : 30,
    "left_choice" : 60,
    "bar_color" : "rgb(48, 229, 255)",
    "title_color" : "white",
    "chart_width" : 950
}

barchart_extras = {
    "text_color" : "all_style_d3('text', {'fill' : 'white'})",
    "text_size" : "all_style_d3('text', {'font-size' : '17px'})"
}

add_d3_visual('sectional_layout_cells', 2, {
    "this_class" : "my_d3",
    "html_path" : "visuals/barchart.html",
    "wrapper_arguments" : barchart_wrapper_args,
    "extra_functions" : barchart_extras
})

// **********************SECTION 2 **************************************
scatter_wrapper_args = {
    "data_path" : "../data/scatter_data.tsv",
    "top_choice" : 30,
    "right_choice" : 30,
    "bottom_choice" : 30,
    "left_choice" : 60,
    "chart_width" : 930
}

scatter_extras = {
    "text_color" : "all_style_d3('text', {'fill' : 'white'})",
    "text_size" : "all_style_d3('text', {'font-size' : '17px'})",
    "circle_size" : "all_style_d3('dot', {'r' : '7px'})",
    "circle_opacity" : "all_style_d3('dot', {'opacity' : 1})"
}

add_d3_visual('sectional_layout_cells', 4, {
    "this_class" : "scatter_chart",
    "html_path" : "visuals/scatter.html",
    "wrapper_arguments" : scatter_wrapper_args,
    "extra_functions" : scatter_extras
})

// **********************SECTION 3 **************************************
remove_element('examples_title', 3)
remove_element('options_layout', 3)

add_layout('sections', 3, {
    "this_class" : "explain_layout",
    "row_class" : "explain_layout_row",
     "cell_class" : "explain_layout_cell",
     "number_of_rows" : 1,
     "number_of_columns" : 2
})

style_layout('explain_layout', 1, {
    "column_widths" : ['90%', '10%'],
    "height" : "auto",
    "width" : "auto",
    "margin-bottom" : "10px",
    "border" : 0
})

add_text('explain_layout_cell', 1, {
    "this_class" : "section_explain",
    "text" : "Communicating between 2 charts. Hover over the bars in the left chart to change the linechart on the right."
})

style_word('section_explain', 1, {
    "this_class" : "hover_word",
    "word" : "Hover",
    "color" : "rgb(254, 225, 180)",
    "font-weight" : "bold"
})

add_icon('explain_layout_cell', 2, {
	"this_class" : "code_icon",
	"icon_class" : "fa-file-code-o"
})

add_event('code_icon', last_class_instance('code_icon'), {
	"type" : "click",
	"function" : "pop_code_modal(this.id)"
})

add_layout('sections', 3, {
    "this_class": "dual_viz_layout",
    "cell_class": "dual_viz_layout_cells",
    "row_class": "dual_viz_layout_rows",
    "number_of_rows": 1,
    "number_of_columns": 2
})

style_layout('dual_viz_layout', 1, {
    "table-layout" : "fixed",
    "border" : 1
})

// ******* BAR CHART 2
barchart_2_wrapper_args = {
    "data_path" : "../data/bar_data_b.tsv",
    "y_title" : "AVG RETURN",
    "top_choice" : 30,
    "right_choice" : 230,
    "bottom_choice" : 30,
    "left_choice" : 60,
    "bar_color" : "rgb(254, 225, 180)",
    "title_color" : "white",
    "chart_width" : 800
}

barchart_2_extras = {
    "pointer_cursor" : "all_style_d3('rect', {'cursor' : 'pointer'})",
    "text_color" : "all_style_d3('text', {'fill' : 'white'})",
    "text_size" : "all_style_d3('text', {'font-size' : '17px'})",
    "call_line_chart" : "all_apply_id('bar'); all_add_event('bar', {'type' : 'hover', 'function' : 'parent.change_line_chart(get_target_instance(this.id))'})"
    }

add_d3_visual('dual_viz_layout_cells', 1, {
    "this_class" : "dual_1",
    "html_path" : "visuals/barchart.html",
    "wrapper_arguments" : barchart_2_wrapper_args,
    "extra_functions" : barchart_2_extras
})

// ******* LINE CHART
linechart_wrapper_args = {
    "data_path" : "../data/linechart_data.tsv",
    "chart_width" : 400,
    "line_color" : "hotpink",
    "text_color" : "white"
}

linechart_extras = {
    "text_color" : "all_style_d3('text', {'fill' : 'white'})",
    "text_size" : "all_style_d3('text', {'font-size' : '17px'})"
    }

add_d3_visual('dual_viz_layout_cells', 2, {
    "this_class" : "dual_2",
    "html_path" : "visuals/linechart.html",
    "wrapper_arguments" : linechart_wrapper_args,
    "extra_functions" : linechart_extras
})


// **********************SECTION 4 **************************************

remove_element('options_layout', 3)
remove_element('examples_title', 3)

style_layout('sectional_layout', 4, {
    "column_widths" : ['30%', '70%'],
    "border" : 0
})

style_layout('sectional_layout_cells', 7, {
    "halign" : "center",
    "padding-left" : "100px",
    "padding-top" : "30px"
})

add_text('sectional_layout_cells', 7, {
    "this_class" : "section_explain",
    "text" : "Run timeline or click on date to see corresponding data."
})

add_layout('sectional_layout_cells', 7, {
    "this_class": "cal_but_layout",
    "cell_class": "cal_but_layout_cells",
    "row_class": "cal_but_layout_rows",
    "number_of_rows": 1,
    "number_of_columns": 2
})

style_layout('cal_but_layout', 1, {
    "column_widths" : ['80%', '20%'],
    "height" : "auto",
    "width" : "auto",
    "border" : 0
})

all_style_layout('cal_but_layout_cells', {
    "halign" : "center"
})

add_button('cal_but_layout_cells', 1, {
	"this_class"  : 'run_timeline_button',
	"text" : "PLAY"
})

style_button('run_timeline_button', 1, {
	 "width" : "190px",
     "background" : "rgb(16, 168, 180)",
     "margin-top" : "10px",
     "margin-bottom" : "10px"
})

add_event('run_timeline_button', 1, {
    "type" : "click",
    "function" : "play_timeline()"
})

add_button('cal_but_layout_cells', 2, {
	"this_class"  : 'stop_timeline_button',
	"text" : "STOP"
})

style_button('stop_timeline_button', 1, {
    "background" : "rgba(179, 180, 153, 0.41)"
})

add_event('stop_timeline_button', 1, {
    "type" : "click",
    "function" : `
        stop_call_every()
        style_button('run_timeline_button', 1, {
            "pointer-events" : "auto"
        })
        style_layout('calendar_layout', 1, {
            "pointer-events" : "auto"
        })
        stop_delay_event()
        `
})

add_layout('sectional_layout_cells', 7, {
    "this_class": "calendar_layout",
    "cell_class": "calendar_layout_cells",
    "row_class": "calendar_layout_rows",
    "number_of_rows": 6,
    "number_of_columns": 7
})

style_layout('calendar_layout', 1, {
    "table-layout" : "fixed",
    "border" : 1
})

style_layout('calendar_layout_rows', 1, {
    "background" : "rgba(255, 156, 62, 0.64)"
})

all_add_event('calendar_layout_cells', {
    "type" : "hover",
    "function" : "all_style_layout('calendar_layout_cells', {'background' : 'transparent', 'cursor' : 'pointer'}); style_layout('calendar_layout_cells', get_target_instance(this.id), {'background' : 'limegreen'})"
})

all_add_event('calendar_layout_cells', {
    "type" : "click",
    "function" : `
        call_d3_extra('piechart', 1, {
            "extra_functions" : piechart_extras,
            "click_button" : "click_element('randomize', 1)"
        })
    `
})

cal_adds = ['S','M','T','W','T','F','S','','','','','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31']
call_multiple({
    "iterations" : 42,
    "function" : `
        add_text('calendar_layout_cells', index+1, {'this_class' : 'cal_text', 'text': cal_adds[index]})
        all_style_text('cal_text', {'color' : 'white', 'align' : 'center'})
        `
})

piechart_wrapper_args = {
}

piechart_extras = {
    "text_color" : "all_style_d3('text', {'fill' : 'white'})",
    "line_color" : "all_style_d3('polyline', {'stroke' : 'rgb(39, 228, 255)'})",
    "line_opacity" : "all_style_d3('polyline', {'opacity' : 0.9})",
    "hide_button" : "all_style_d3('button', {'visibility' : 'hidden'})"
}

add_d3_visual('sectional_layout_cells', 8, {
    "this_class" : "piechart",
    "html_path" : "visuals/pie_chart.html",
    "wrapper_arguments" : piechart_wrapper_args,
    "extra_functions" : piechart_extras
})


// _all styles
all_style_layout('sectional_layout_cells', {
    "valign" : "top"
})
all_style_layout('options_layout_cells', {
    "halign" : "center"
})
all_style_layout('options_layout', {
    "border" : 0
})
all_style_text('examples_title', {
    "color" : "white",
    "align" : "center",
    "padding" : "10px",
    "font-size" : "22px"
})
all_style_icon('code_icon', {
	 "font-size" : "30px",
     "color" : "rgba(221, 173, 81, 0.92)",
     "padding" : "2px",
     "cursor" : "pointer"
})
all_style_text('section_explain', {
    "color" : "white",
    "font-size" : "18px"
})

// **********************SECTION 5 **************************************

circlepack_wrapper_args = {
    "data_path" : "../data/flare.json",
    "chart_width" : 600,
    "chart_height" : 600,
    "chart_radius" : 450
}

circlepack_extras = {
    "top" : "style_d3('svg', 1, {'margin-top' : '-60px'})"
}

add_d3_visual('sectional_layout_cells', 10, {
    "this_class" : "map",
    "html_path" : "visuals/circlepack.html",
    "wrapper_arguments" : circlepack_wrapper_args,
    "extra_functions" : circlepack_extras
})

// **********************SECTION 6 **************************************


</script>



